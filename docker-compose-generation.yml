# Registration and Generation of Entities
version: "2.1"

networks:
  aether:
    external:
      name: aether_internal

services:

  # ---------------------------------
  # Mock Data Container
  # ---------------------------------

  assets:
    image: aether-assets
    build:
      context: ./assets/generation
      dockerfile: Dockerfile
    volumes:
      - ./assets:/code/assets
    environment:
      KERNEL_URL: http://kernel:8000
      KERNEL_USER: ${KERNEL_ADMIN_USERNAME}
      KERNEL_PASSWORD: ${KERNEL_ADMIN_PASSWORD}
      PROJECT_NAME: DefaultDemo
      SUBMISSION_ENDPOINT: default_mapping
    networks:
      - aether


  # ---------------------------------
  # Auth builder Container
  # ---------------------------------

  auth:
    image: aether-auth
    build: ./api-auth/aether-auth
    environment:
      DEBUG: null

      KEYCLOAK_GLOBAL_ADMIN: ${KEYCLOAK_GLOBAL_ADMIN}
      KEYCLOAK_GLOBAL_PASSWORD: ${KEYCLOAK_GLOBAL_PASSWORD}
      KEYCLOAK_KONG_CLIENT: ${KEYCLOAK_KONG_CLIENT}

      BASE_DOMAIN: ${BASE_DOMAIN}
      BASE_HOST: ${BASE_HOST}
      KEYCLOAK_INTERNAL: ${KEYCLOAK_INTERNAL}
      KONG_INTERNAL: ${KONG_INTERNAL}
      MINIO_INTERNAL: ${MINIO_INTERNAL}
    volumes:
      - ./api-auth/aether-auth:/code
    command: help
    networks:
      - aether
